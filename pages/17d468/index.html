<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL索引</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/java-notes/img/favicon.ico">
    <meta name="description" content="知识管理">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/java-notes/assets/css/0.styles.fb2e25c6.css" as="style"><link rel="preload" href="/java-notes/assets/js/app.d397b22c.js" as="script"><link rel="preload" href="/java-notes/assets/js/2.f70b3895.js" as="script"><link rel="preload" href="/java-notes/assets/js/15.7637f176.js" as="script"><link rel="prefetch" href="/java-notes/assets/js/10.2adfc515.js"><link rel="prefetch" href="/java-notes/assets/js/11.28dcb787.js"><link rel="prefetch" href="/java-notes/assets/js/12.2a292b61.js"><link rel="prefetch" href="/java-notes/assets/js/13.3f1dfbd4.js"><link rel="prefetch" href="/java-notes/assets/js/14.337236bc.js"><link rel="prefetch" href="/java-notes/assets/js/16.dc014ebd.js"><link rel="prefetch" href="/java-notes/assets/js/17.d0e4e790.js"><link rel="prefetch" href="/java-notes/assets/js/18.a5049df9.js"><link rel="prefetch" href="/java-notes/assets/js/19.346aa9f6.js"><link rel="prefetch" href="/java-notes/assets/js/20.ea34675a.js"><link rel="prefetch" href="/java-notes/assets/js/21.72feca8c.js"><link rel="prefetch" href="/java-notes/assets/js/22.5aa91d64.js"><link rel="prefetch" href="/java-notes/assets/js/23.f5dc3702.js"><link rel="prefetch" href="/java-notes/assets/js/24.ede98ecc.js"><link rel="prefetch" href="/java-notes/assets/js/25.96dad39b.js"><link rel="prefetch" href="/java-notes/assets/js/26.da17699a.js"><link rel="prefetch" href="/java-notes/assets/js/27.09d5fc3b.js"><link rel="prefetch" href="/java-notes/assets/js/28.d82616db.js"><link rel="prefetch" href="/java-notes/assets/js/29.e1686044.js"><link rel="prefetch" href="/java-notes/assets/js/3.68505a47.js"><link rel="prefetch" href="/java-notes/assets/js/30.86d62f2d.js"><link rel="prefetch" href="/java-notes/assets/js/31.8b9dad5a.js"><link rel="prefetch" href="/java-notes/assets/js/32.3588a7d0.js"><link rel="prefetch" href="/java-notes/assets/js/33.3dbbfd6b.js"><link rel="prefetch" href="/java-notes/assets/js/34.9adfa464.js"><link rel="prefetch" href="/java-notes/assets/js/35.a8146fb2.js"><link rel="prefetch" href="/java-notes/assets/js/36.4bbba0d8.js"><link rel="prefetch" href="/java-notes/assets/js/37.3d247b0f.js"><link rel="prefetch" href="/java-notes/assets/js/38.d0c2890b.js"><link rel="prefetch" href="/java-notes/assets/js/39.a1e26461.js"><link rel="prefetch" href="/java-notes/assets/js/4.79b93306.js"><link rel="prefetch" href="/java-notes/assets/js/40.33e37909.js"><link rel="prefetch" href="/java-notes/assets/js/41.b22b997f.js"><link rel="prefetch" href="/java-notes/assets/js/42.af86b93f.js"><link rel="prefetch" href="/java-notes/assets/js/43.c88942c6.js"><link rel="prefetch" href="/java-notes/assets/js/44.864ea6c7.js"><link rel="prefetch" href="/java-notes/assets/js/45.37e9acf1.js"><link rel="prefetch" href="/java-notes/assets/js/46.2a8ee5fe.js"><link rel="prefetch" href="/java-notes/assets/js/47.13102c5d.js"><link rel="prefetch" href="/java-notes/assets/js/48.5e02063f.js"><link rel="prefetch" href="/java-notes/assets/js/49.5902bf17.js"><link rel="prefetch" href="/java-notes/assets/js/5.d7e4c5f6.js"><link rel="prefetch" href="/java-notes/assets/js/50.5ed3edee.js"><link rel="prefetch" href="/java-notes/assets/js/51.7760a883.js"><link rel="prefetch" href="/java-notes/assets/js/52.f14b692e.js"><link rel="prefetch" href="/java-notes/assets/js/53.df43b82d.js"><link rel="prefetch" href="/java-notes/assets/js/54.391d2efe.js"><link rel="prefetch" href="/java-notes/assets/js/55.e1d64285.js"><link rel="prefetch" href="/java-notes/assets/js/56.12d3c417.js"><link rel="prefetch" href="/java-notes/assets/js/57.465c2ade.js"><link rel="prefetch" href="/java-notes/assets/js/58.b86ff1af.js"><link rel="prefetch" href="/java-notes/assets/js/59.a2969c73.js"><link rel="prefetch" href="/java-notes/assets/js/6.ad13b64c.js"><link rel="prefetch" href="/java-notes/assets/js/60.3970fce2.js"><link rel="prefetch" href="/java-notes/assets/js/61.69a94672.js"><link rel="prefetch" href="/java-notes/assets/js/62.94da23dc.js"><link rel="prefetch" href="/java-notes/assets/js/63.f2950404.js"><link rel="prefetch" href="/java-notes/assets/js/64.895ba847.js"><link rel="prefetch" href="/java-notes/assets/js/65.bb29c100.js"><link rel="prefetch" href="/java-notes/assets/js/66.70d3b479.js"><link rel="prefetch" href="/java-notes/assets/js/67.a242cece.js"><link rel="prefetch" href="/java-notes/assets/js/68.abd94893.js"><link rel="prefetch" href="/java-notes/assets/js/69.60cece2e.js"><link rel="prefetch" href="/java-notes/assets/js/7.8e50d771.js"><link rel="prefetch" href="/java-notes/assets/js/70.0b44f657.js"><link rel="prefetch" href="/java-notes/assets/js/71.c324bf57.js"><link rel="prefetch" href="/java-notes/assets/js/72.8aa10de8.js"><link rel="prefetch" href="/java-notes/assets/js/73.1e7220c4.js"><link rel="prefetch" href="/java-notes/assets/js/74.d1c0ce09.js"><link rel="prefetch" href="/java-notes/assets/js/75.42ffe6a2.js"><link rel="prefetch" href="/java-notes/assets/js/76.e92e283d.js"><link rel="prefetch" href="/java-notes/assets/js/77.0f7fadf2.js"><link rel="prefetch" href="/java-notes/assets/js/78.2a59eb91.js"><link rel="prefetch" href="/java-notes/assets/js/8.a2306c4b.js"><link rel="prefetch" href="/java-notes/assets/js/9.7e1ead44.js">
    <link rel="stylesheet" href="/java-notes/assets/css/0.styles.fb2e25c6.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/java-notes/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java-notes/" class="nav-link">首页</a></div><div class="nav-item"><a href="/java-notes/pages/0e35d1/" class="nav-link">Java 知识体系</a></div><div class="nav-item"><a href="/java-notes/pages/5547aa/" class="nav-link">Java 面试宝典</a></div><div class="nav-item"><a href="/java-notes/pages/1eb629/" class="nav-link">软技能</a></div> <a href="https://github.com/xiong201" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/java-notes/" class="nav-link">首页</a></div><div class="nav-item"><a href="/java-notes/pages/0e35d1/" class="nav-link">Java 知识体系</a></div><div class="nav-item"><a href="/java-notes/pages/5547aa/" class="nav-link">Java 面试宝典</a></div><div class="nav-item"><a href="/java-notes/pages/1eb629/" class="nav-link">软技能</a></div> <a href="https://github.com/xiong201" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>数据库</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-notes/pages/67462f/" class="sidebar-link">数据库基础与SQL</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>MySQL</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-notes/pages/c9b13a/" class="sidebar-link">MySQL简介</a></li><li><a href="/java-notes/pages/198df0/" class="sidebar-link">MySQL体系结构</a></li><li><a href="/java-notes/pages/17d468/" aria-current="page" class="active sidebar-link">MySQL索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#b-树" class="sidebar-link">B+树</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level1"><a href="/java-notes/pages/17d468/#innodb逻辑存储结构" class="sidebar-link">InnoDB逻辑存储结构</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#表空间" class="sidebar-link">表空间</a></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#段" class="sidebar-link">段</a></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#区" class="sidebar-link">区</a></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#页" class="sidebar-link">页</a></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#行" class="sidebar-link">行</a></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#行记录格式" class="sidebar-link">行记录格式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#compact行记录格式" class="sidebar-link">Compact行记录格式</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#redundant行记录格式" class="sidebar-link">Redundant行记录格式</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#行溢出数据" class="sidebar-link">行溢出数据</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#compressed和dynamic行记录格式" class="sidebar-link">Compressed和Dynamic行记录格式</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#innodb数据页结构" class="sidebar-link">InnoDB数据页结构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#file-header" class="sidebar-link">File Header</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#page-header" class="sidebar-link">Page Header</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#infimum和supremum-record" class="sidebar-link">Infimum和Supremum Record</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#user-record和free-space" class="sidebar-link">User Record和Free Space</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#page-directory" class="sidebar-link">Page Directory</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#file-trailer" class="sidebar-link">File Trailer</a></li><li class="sidebar-sub-header level1"><a href="/java-notes/pages/17d468/#索引分类" class="sidebar-link">索引分类</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#功能逻辑分类" class="sidebar-link">功能逻辑分类</a></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#作用字段个数分类" class="sidebar-link">作用字段个数分类</a></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#物理实现方式分类" class="sidebar-link">物理实现方式分类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#聚簇索引" class="sidebar-link">聚簇索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#非聚簇索引" class="sidebar-link">非聚簇索引</a></li><li class="sidebar-sub-header level4"><a href="/java-notes/pages/17d468/#覆盖索引" class="sidebar-link">覆盖索引</a></li><li class="sidebar-sub-header level1"><a href="/java-notes/pages/17d468/#索引语法" class="sidebar-link">索引语法</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#创建索引" class="sidebar-link">创建索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#创建表时创建索引" class="sidebar-link">创建表时创建索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#在已存在的表上创建索引" class="sidebar-link">在已存在的表上创建索引</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#查看索引" class="sidebar-link">查看索引</a></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#删除索引" class="sidebar-link">删除索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level1"><a href="/java-notes/pages/17d468/#索引设计原则" class="sidebar-link">索引设计原则</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#哪些情况适合创建索引" class="sidebar-link">哪些情况适合创建索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_1-字段的数值有唯一性的限制" class="sidebar-link">1.字段的数值有唯一性的限制</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_2-频繁作为where查询条件的字段" class="sidebar-link">2.频繁作为WHERE查询条件的字段</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_3-经常group-by-和order-by-的列" class="sidebar-link">3.经常GROUP BY 和ORDER BY 的列</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_4-update、delete的where条件列" class="sidebar-link">4.UPDATE、DELETE的WHERE条件列</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_5-distinct字段需要创建索引" class="sidebar-link">5.DISTINCT字段需要创建索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_6-多表join连接时-对连接的字段和where条件创建索引" class="sidebar-link">6.多表JOIN连接时，对连接的字段和WHERE条件创建索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_7-使用列的类型小的创建索引" class="sidebar-link">7.使用列的类型小的创建索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_8-使用字符串前缀创建索引" class="sidebar-link">8.使用字符串前缀创建索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_9-区分度高-散列性高-的列适合作为索引" class="sidebar-link">9.区分度高(散列性高)的列适合作为索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_10-使用最频繁的列放到联合索引的左侧" class="sidebar-link">10.使用最频繁的列放到联合索引的左侧</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_11-在多个字段都要创建索引的情况下-联合索引优于单值索引" class="sidebar-link">11.在多个字段都要创建索引的情况下，联合索引优于单值索引</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-notes/pages/17d468/#哪些情况不适合创建索引" class="sidebar-link">哪些情况不适合创建索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_1-where中使用不到的字段-不要设置索引" class="sidebar-link">1.WHERE中使用不到的字段，不要设置索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_2-数据量小的表最好不要使用索引" class="sidebar-link">2.数据量小的表最好不要使用索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_3-有大量重复数据的列上不要建立索引" class="sidebar-link">3.有大量重复数据的列上不要建立索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_4-避免对经常更新的表创建过多的索引" class="sidebar-link">4.避免对经常更新的表创建过多的索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_5-不建议用无序的值作为索引" class="sidebar-link">5.不建议用无序的值作为索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_6-删除不再使用或者很少使用的索引" class="sidebar-link">6.删除不再使用或者很少使用的索引</a></li><li class="sidebar-sub-header level3"><a href="/java-notes/pages/17d468/#_7-不要定义冗余或重复的索引" class="sidebar-link">7.不要定义冗余或重复的索引</a></li></ul></li></ul></li><li><a href="/java-notes/pages/ec5067/" class="sidebar-link">MySQL调优</a></li><li><a href="/java-notes/pages/f7fcac/" class="sidebar-link">MySQL命令大全</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>系统设计</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>代码质量</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/java-notes/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>Java 知识体系</span></li><li data-v-06225672><span data-v-06225672>数据库</span></li><li data-v-06225672><span data-v-06225672>MySQL</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>Xiong</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-10-24</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">MySQL索引<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p><strong>索引（Index）是帮助MySQL高效获取数据的数据结构</strong>。由具体的存储引擎实现。</p> <p>索引的优点：</p> <ol><li><p>提高数据检索的效率，降低<strong>数据库的IO成本</strong>。这是创建索引最主要的原因。</p></li> <li><p>通过创建唯一索引，保证数据库表中每一行<strong>数据的唯一性</strong>。</p></li> <li><p><strong>可以加速表和表之间的连接</strong>。对于有依赖关系的子表和父表联合查询时，可以提高查询速度。</p></li> <li><p>可以<strong>显著减少查询中分组和排序的时间</strong>。</p></li></ol> <p>索引的缺点：</p> <ol><li>创建索引和维护索引要<strong>耗费时间</strong>，并且随着数据量的增加，耗费的时间也会增加。</li> <li>索引需要占<strong>磁盘空间</strong>。</li> <li>索引在提高查询速度的同时，也会降低<strong>更新表的速度</strong>。</li></ol> <h1 id="索引实现方案"><a href="#索引实现方案" class="header-anchor">#</a> 索引实现方案</h1> <h2 id="b-树"><a href="#b-树" class="header-anchor">#</a> B+树</h2> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230117094650455.png" alt="image-20230117094650455"></p> <p>B+树的根页面位置万年不动。InnoDB和MyISAM默认实现B+树实现索引。但是InnoDB叶子节点存储的是<strong>完整数据</strong>，而MyISAM存储的是<strong>数据记录的地址</strong>。</p> <h1 id="innodb逻辑存储结构"><a href="#innodb逻辑存储结构" class="header-anchor">#</a> InnoDB逻辑存储结构</h1> <p>所有数据都被逻辑地存放到表空间（tablespace）。表空间又由段（segment）、区（extent）、页（page）组成。如下图所示</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230122195226427.png" alt="image-20230122195226427"></p> <h2 id="表空间"><a href="#表空间" class="header-anchor">#</a> 表空间</h2> <p>表空间是InnoDB存储引擎逻辑结构的最高层，所有数据都存放在表空间中。</p> <p>默认情况下InnoDB存储引擎有一个共享表空间ibdata1，所有数据都会存放在这个表空间内。如果启用了参数innodb_file_per_table，则每张表内的数据都可以存放在单独的表空间内，但是索引、插入缓冲Bitmap页，其他类的数据（如回滚信息，插入缓冲索引页、系统事务信息，二次写缓冲等）还是存放在原来的共享表空间。<strong>即使启用了参数innodb_file_per_table，共享表空间还是会不断地增加其大小</strong>。</p> <p>执行rollback时并不会取收缩表空间，但是会根据需求判断这些空间是否为可用空间，是的话这些可用空间将会被再次使用。</p> <h2 id="段"><a href="#段" class="header-anchor">#</a> 段</h2> <p>表空间由各个段组成的，常见的段有数据段、索引段、回滚段等。</p> <h2 id="区"><a href="#区" class="header-anchor">#</a> 区</h2> <p>区是由连续页组成的空间，在任何情况下每个区的大小都为1MB。</p> <p>为了保证区中页的连续性，InnoDB存储引擎一次从磁盘申请4～5个区。在默认情况下，InnoDB存储引擎页的大小为16KB，即一个区中一共有64个连续的页。</p> <h2 id="页"><a href="#页" class="header-anchor">#</a> 页</h2> <p>页是InnoDB磁盘管理的最小单位。在InnoDB存储引擎中，默认每个页的大小为16KB。</p> <p>InnoDB 1.2版本后可以通过参数innodb_page_size将页的大小设置为4K、8K、16K。</p> <p>InnoDB存储引擎常见的页类型：</p> <ul><li>数据页（B-tree Node）</li> <li>undo页（undo Log Page）</li> <li>系统页（System Page）</li> <li>事务数据页（Transaction system Page）</li> <li>插入缓冲位图页（Insert Buffer Bitmap）</li> <li>插入缓冲空闲列表页（Insert Buffer Free List）</li> <li>未压缩的二进制大对象页（Uncompressed BLOB Page）</li> <li>压缩的二进制大对象页（compressed BLOB Page）</li></ul> <h2 id="行"><a href="#行" class="header-anchor">#</a> 行</h2> <p>InnoDB存储引擎数据按行存放，最多允许存放16KB/2-200行的记录，即7992行记录。</p> <h2 id="行记录格式"><a href="#行记录格式" class="header-anchor">#</a> 行记录格式</h2> <p>页中保存着表中一行行的数据。在InnoDB 1.0.x版本之前，InnoDB存储引擎提供了Compact和Redundant两种格式来存放行记录数据。<strong>在MySQL 5.1版本中，默认设置为Compact行格式</strong>。可以通过命令SHOW TABLE STATUS LIKE'table_name'来查看当前表使用的行格式，其中row_format属性表示当前所使用的行记录结构类型。</p> <h3 id="compact行记录格式"><a href="#compact行记录格式" class="header-anchor">#</a> Compact行记录格式</h3> <p>Compact行记录在MySQL5.0引入，设计目标是高效存储数据。存储方式如下图：</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230128094111701.png" alt="image-20230128094111701"></p> <p>Compact行记录格式<strong>首部是一个非NULL变长字段长度列表，按照列的顺序逆序放置</strong>。长度为：</p> <ul><li>若列的长度小于255字节，用1字节表示；</li> <li>若大于255个字节，用2字节表示。</li></ul> <p>变长字段的长度最大不可以超过2字节，这是因在MySQL数据库中VARCHAR类型的最大长度限制为65535。</p> <p><strong>变长字段之后的第二个部分是NULL标志位，该位指示了该行数据中是否有NULL值</strong>，有则用1表示。该部分所占的字节应该为1字节。</p> <p><strong>接下来的部分是记录头信息（record header），固定占用5字节（40位）</strong>，每位的含义如下图：</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230128094700034.png" alt="image-20230128094700034"></p> <p><strong>最后部分是实际存储每个列的数据</strong>。NULL不占该部分任何空间，即NULL除了占有NULL标志位，实际存储不占有任何空间。每行数据<strong>除了用户定义的列外，还有两个隐藏列，事务ID列和回滚指针列</strong>，分别为6字节和7字节的大小。若InnoDB表没有定义主键，每行还会增加一个6字节的rowid列。</p> <h3 id="redundant行记录格式"><a href="#redundant行记录格式" class="header-anchor">#</a> Redundant行记录格式</h3> <p>Redundant是MySQL 5.0版本之前InnoDB的行记录存储方式，MySQL 5.0支持Redundant是为了兼容之前版本的页格式。Redundant行记录如图：</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230128095925159.png" alt="image-20230128095925159"></p> <p><strong>Redundant行记录格式的首部是一个字段长度偏移列表</strong>，同样是按照列的顺序逆序放置的。若列的长度小于255字节，用1字节表示；若大于255字节，用2字节表示。</p> <p><strong>第二个部分为记录头信息（record header</strong>），不同于Compact行记录格式，Redundant行记录格式的记录头占用6字节（48位），每位含义如图：</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230128100128381.png" alt="image-20230128100128381"></p> <p><strong>最后的部分为实际存储的每个列的数据</strong>。</p> <p>对于VARCHAR类型的NULL值，Redundant行记录格式同样不占用任何存储空间，而CHAR类型的NULL值需要占用空间。</p> <h3 id="行溢出数据"><a href="#行溢出数据" class="header-anchor">#</a> 行溢出数据</h3> <p>行溢出指的是当页中只能存放下一条记录，InnoDB存储引擎会自动将行数据存放到溢出页。</p> <p>MySQL官方手册定义的VARCHAR类型支持最大65532<strong>字节</strong>，但实际能存放VARCHAR类型的最大长度为65532，因为还有别的开销。创建表时VARCHAR（N）中的N指的是<strong>字符</strong>的长度。这个长度是指所有VARCHAR列的长度总和，如果列的长度总和超出这个长度，依然无法创建。</p> <p>在一般情况下，InnoDB存储引擎的数据都是存放在页类型为B-tree node中。但是当发生行溢出时，数据存放在页类型为Uncompress BLOB页中。行溢出数据存放方式如下</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230128103213688.png" alt="image-20230128103213688"></p> <p>当发生行溢出时，数据页只保存前一部分字节数据，后面保存的是偏移量，指向行溢出页。</p> <h3 id="compressed和dynamic行记录格式"><a href="#compressed和dynamic行记录格式" class="header-anchor">#</a> Compressed和Dynamic行记录格式</h3> <p>InnoDB 1.0.x版本引入新的文件格式Barracuda文件格式。Barracuda文件格式下拥有两种新的行记录格式：Compressed和Dynamic。</p> <p>新的两种记录格式对于存放在BLOB中的数据采用了完全的行溢出的方式，如图</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230128103825800.png" alt="image-20230128103825800"></p> <p>在数据页中只存放20个字节的指针，实际的数据都存放在Off Page中，而之前的Compact和Redundant两种格式会存放768个前缀字节。</p> <p>Compressed行记录格式的另一个功能就是，存储在其中的行数据会以zlib的算法进行压缩，因此对于BLOB、TEXT、VARCHAR这类大长度类型的数据能够进行非常有效的存储。</p> <h2 id="innodb数据页结构"><a href="#innodb数据页结构" class="header-anchor">#</a> InnoDB数据页结构</h2> <p>InnoDB数据页由7个部分组成，如图所示</p> <ul><li>File Header（文件头）</li> <li>Page Header（页头）</li> <li>Infimun和Supremum Records</li> <li>User Records（用户记录，即行记录）</li> <li>Free Space（空闲空间）</li> <li>Page Directory（页目录）</li> <li>File Trailer（文件结尾信息）</li></ul> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230207112712282.png" alt="image-20230207112712282"></p> <p>其中File Header、Page Header、File Trailer的大小是固定的，分别为38、56、8字节。User Records、Free Space、Page Directory这些部分为实际的行记录存储空间，因此大小是动态的。</p> <h3 id="file-header"><a href="#file-header" class="header-anchor">#</a> File Header</h3> <p>File Header用来记录一些头信息，共占用38字节。组成部分如图：</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230207113148905.png" alt="image-20230207113148905"></p> <p>FIL_PAGE_TYPE是InnoDB存储引擎的类型，常见的类型如图</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230207113313552.png" alt="image-20230207113313552"></p> <h3 id="page-header"><a href="#page-header" class="header-anchor">#</a> Page Header</h3> <p>Page Header用来记录数据页的状态信息，由14部分组成，占用56字节，如图所示</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230207113703074.png" alt="image-20230207113703074"></p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230207113635431.png" alt="image-20230207113635431"></p> <h3 id="infimum和supremum-record"><a href="#infimum和supremum-record" class="header-anchor">#</a> Infimum和Supremum Record</h3> <p>InnoDB存储引擎中，每个数据页中有两个虚拟的行记录，用来限定记录的边界。Infimum记录是比该页中任何主键值都要小的值，Supremum指比任何可能大的值还要大的值。这两个值在页创建时被建立，并且在任何情况下不会被删除。在Compact行格式和Redundant行格式下，两者占用的字节数各不相同。图4-7显示了Infimum和Supremum记录。</p> <p><img src="https://notes-img2022.oss-cn-shenzhen.aliyuncs.com/img/image-20230207115129723.png" alt="image-20230207115129723"></p> <h3 id="user-record和free-space"><a href="#user-record和free-space" class="header-anchor">#</a> User Record和Free Space</h3> <p>User Record是实际存储行记录的内容。Free Space是空闲空间，也是个链表数据结构。一条记录被删除后，该空间会加入到空闲链表中。</p> <h3 id="page-directory"><a href="#page-directory" class="header-anchor">#</a> Page Directory</h3> <p>Page Directory（页目录）存放了记录的相对位置（页的相对位置，而不是偏移量），有时这些记录指针被称为Slots（槽）或者目录槽（Directory Slots）</p> <h3 id="file-trailer"><a href="#file-trailer" class="header-anchor">#</a> File Trailer</h3> <p>File Trailer只有一个FIL_PAGE_END_LSN部分，占用8字节。前4字节代表该页的checksum值，最后4字节和File Header中的FIL_PAGE_LSN相同。将这两个值与File Header中的FIL_PAGE_SPACE_OR_CHKSUM和FIL_PAGE_LSN值进行比较，看是否一致（checksum的比较需要通过InnoDB的checksum函数来进行比较，不是简单的等值比较），以此来保证页的完整性（not corrupted）。</p> <h1 id="索引分类"><a href="#索引分类" class="header-anchor">#</a> 索引分类</h1> <h2 id="功能逻辑分类"><a href="#功能逻辑分类" class="header-anchor">#</a> 功能逻辑分类</h2> <p>普通索引、唯一索引、主键索引、全文索引。</p> <h2 id="作用字段个数分类"><a href="#作用字段个数分类" class="header-anchor">#</a> 作用字段个数分类</h2> <p>单列索引和联合索引。</p> <h2 id="物理实现方式分类"><a href="#物理实现方式分类" class="header-anchor">#</a> 物理实现方式分类</h2> <h3 id="聚簇索引"><a href="#聚簇索引" class="header-anchor">#</a> 聚簇索引</h3> <p>特点：</p> <ol><li>使用记录主键值的大小进行记录和页的排序。
<ul><li><strong>页内</strong>的记录按照主键顺序排序成一个<strong>单向链表</strong>。</li> <li>各个存放<strong>用户记录的页</strong>根据页中用户记录的主键大小排成一个<strong>双向链表</strong>。</li> <li>存放<strong>目录项记录的页</strong>分为不同的层次，在同一层次中的页根据目录项的主键大小顺序排成一个<strong>双向链表</strong>。</li></ul></li> <li>B+树的<strong>叶子节点</strong>存储的是完整的用户记录。即存储了所有列的值（包括隐藏列）</li></ol> <p>优点：</p> <ul><li><strong>数据访问快</strong>。因为索引和数据保存在同一个B+树中。</li> <li>对主键的排序查找和范围查找速度非常快。</li></ul> <p>缺点：</p> <ul><li><strong>插入速度严重依赖于插入顺序</strong>，按照主键的顺序插入是最快的方式。</li> <li><strong>更新主键的代价高</strong>，因为会导致被更新的行移动。</li></ul> <h3 id="非聚簇索引"><a href="#非聚簇索引" class="header-anchor">#</a> 非聚簇索引</h3> <p>非聚簇索引在自己的B+树中只能查找到记录的主键值。要查找完整的用户记录的话，需要到聚簇索引中再查一遍，这个过程称为<strong>回表</strong>。</p> <h4 id="覆盖索引"><a href="#覆盖索引" class="header-anchor">#</a> 覆盖索引</h4> <p>使用非聚簇索引时，查询里用到的列包含在索引列+主键当中。此时无须进行回表，就可以将查询数据返回。</p> <h1 id="索引语法"><a href="#索引语法" class="header-anchor">#</a> 索引语法</h1> <h2 id="创建索引"><a href="#创建索引" class="header-anchor">#</a> 创建索引</h2> <p>MySQL支持多种方法在单个或多个列创建索引：在创建表的定义语句CREATE TABLE指定索引列，使用ALTER TABLE语句已存在表上创建索引，使用CREATE INDEX语句在已存在表上添加索引。</p> <h3 id="创建表时创建索引"><a href="#创建表时创建索引" class="header-anchor">#</a> 创建表时创建索引</h3> <p>主键默认添加主键索引。</p> <p>显示创建表时创建索引，语法格式如下：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span>col_name data_type<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">UNIQUE</span> <span class="token operator">|</span> FULLTEXT <span class="token operator">|</span> SPATIAL<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">INDEX</span> <span class="token operator">|</span> <span class="token keyword">KEY</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>index_name<span class="token punctuation">]</span> <span class="token punctuation">(</span>col_name <span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token keyword">ASC</span> <span class="token operator">|</span>
<span class="token keyword">DESC</span><span class="token punctuation">]</span>
</code></pre></div><ul><li>UNIQUE 、 FULLTEXT 和 SPATIAL 为可选参数，分别表示唯一索引、全文索引和空间索引；</li> <li>INDEX 与 KEY 为同义词，两者的作用相同，用来指定创建索引；</li> <li>index_name 指定索引的名称，为可选参数，如果不指定，那么MySQL默认col_name为索引名；</li> <li>col_name 为需要创建索引的字段列，该列必须从数据表中定义的多个列中选择；</li> <li>length 为可选参数，表示索引的长度，只有字符串类型的字段才能指定索引长度；</li> <li>ASC 或 DESC 指定升序或者降序的索引值存储。</li></ul> <h3 id="在已存在的表上创建索引"><a href="#在已存在的表上创建索引" class="header-anchor">#</a> 在已存在的表上创建索引</h3> <ol><li><p>使用ALTER TABLE语句创建索引 ALTER TABLE语句创建索引的基本语法如下：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token punctuation">[</span><span class="token keyword">UNIQUE</span> <span class="token operator">|</span> FULLTEXT <span class="token operator">|</span> SPATIAL<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">INDEX</span> <span class="token operator">|</span> <span class="token keyword">KEY</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>index_name<span class="token punctuation">]</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token keyword">ASC</span> <span class="token operator">|</span> <span class="token keyword">DESC</span><span class="token punctuation">]</span>
</code></pre></div></li> <li><p>使用CREATE INDEX创建索引 CREATE INDEX语句可以在已经存在的表上添加索引，在MySQL中，CREATE INDEX被映射到一个ALTER TABLE语句上，基本语法结构为：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">UNIQUE</span> <span class="token operator">|</span> FULLTEXT <span class="token operator">|</span> SPATIAL<span class="token punctuation">]</span> <span class="token keyword">INDEX</span> index_name
<span class="token keyword">ON</span> table_name <span class="token punctuation">(</span>col_name<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token keyword">ASC</span> <span class="token operator">|</span> <span class="token keyword">DESC</span><span class="token punctuation">]</span>
</code></pre></div></li></ol> <h2 id="查看索引"><a href="#查看索引" class="header-anchor">#</a> 查看索引</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span><span class="token keyword">TABLE</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="删除索引"><a href="#删除索引" class="header-anchor">#</a> 删除索引</h2> <ol><li><p>使用ALTER TABLE删除索引 ALTER TABLE删除索引的基本语法格式如下：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name<span class="token punctuation">;</span>
</code></pre></div></li> <li><p>使用DROP INDEX语句删除索引 DROP INDEX删除索引的基本语法格式如下：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name<span class="token punctuation">;</span>
</code></pre></div></li></ol> <h1 id="索引设计原则"><a href="#索引设计原则" class="header-anchor">#</a> 索引设计原则</h1> <h2 id="哪些情况适合创建索引"><a href="#哪些情况适合创建索引" class="header-anchor">#</a> 哪些情况适合创建索引</h2> <h3 id="_1-字段的数值有唯一性的限制"><a href="#_1-字段的数值有唯一性的限制" class="header-anchor">#</a> 1.字段的数值有唯一性的限制</h3> <blockquote><p>业务上具有唯一特性的字段，即使是组合字段，也必须建成唯一索引。（来源：Alibaba）
说明：不要以为唯一索引影响了 insert 速度，这个速度损耗可以忽略，但提高查找速度是明显的。</p></blockquote> <h3 id="_2-频繁作为where查询条件的字段"><a href="#_2-频繁作为where查询条件的字段" class="header-anchor">#</a> 2.频繁作为WHERE查询条件的字段</h3> <p>某个字段在SELECT语句的 WHERE 条件中经常被使用到，那么就需要给这个字段创建索引了。尤其是在数据量大的情况下，创建普通索引就可以大幅提升数据查询的效率。</p> <h3 id="_3-经常group-by-和order-by-的列"><a href="#_3-经常group-by-和order-by-的列" class="header-anchor">#</a> 3.经常GROUP BY 和ORDER BY 的列</h3> <p>索引就是让数据按照某种顺序进行存储或检索，因此当我们使用 GROUP BY 对数据进行分组查询，或者使用 ORDER BY 对数据进行排序的时候，就需要 <strong>对分组或者排序的字段进行索引</strong> 。如果待排序的列有多个，那么可以在这些列上建立 <strong>组合索引</strong> 。</p> <h3 id="_4-update、delete的where条件列"><a href="#_4-update、delete的where条件列" class="header-anchor">#</a> 4.UPDATE、DELETE的WHERE条件列</h3> <p>对数据按照某个条件进行查询后再进行 UPDATE 或 DELETE 的操作，如果对 WHERE 字段创建了索引，就能大幅提升效率。原理是因为我们需要先根据 WHERE 条件列检索出来这条记录，然后再对它进行更新或删除。<strong>如果进行更新的时候，更新的字段是非索引字段，提升的效率会更明显，这是因为非索引字段更新不需要对索引进行维护</strong>。</p> <h3 id="_5-distinct字段需要创建索引"><a href="#_5-distinct字段需要创建索引" class="header-anchor">#</a> 5.DISTINCT字段需要创建索引</h3> <p>索引会对数据按照某种顺序进行排序，所以在去重的时候也会快很多。</p> <h3 id="_6-多表join连接时-对连接的字段和where条件创建索引"><a href="#_6-多表join连接时-对连接的字段和where条件创建索引" class="header-anchor">#</a> 6.多表JOIN连接时，对连接的字段和WHERE条件创建索引</h3> <h3 id="_7-使用列的类型小的创建索引"><a href="#_7-使用列的类型小的创建索引" class="header-anchor">#</a> 7.使用列的类型小的创建索引</h3> <h3 id="_8-使用字符串前缀创建索引"><a href="#_8-使用字符串前缀创建索引" class="header-anchor">#</a> 8.使用字符串前缀创建索引</h3> <blockquote><p>在 varchar 字段上建立索引时，必须指定索引长度，没必要对全字段建立索引，根据实际文本
区分度决定索引长度。
说明：索引的长度与区分度是一对矛盾体，一般对字符串类型数据，长度为 20 的索引，区分度会 高达
90% 以上 ，可以使用 count(distinct left(列名, 索引长度))/count(*)的区分度来确定。</p></blockquote> <h3 id="_9-区分度高-散列性高-的列适合作为索引"><a href="#_9-区分度高-散列性高-的列适合作为索引" class="header-anchor">#</a> 9.区分度高(散列性高)的列适合作为索引</h3> <h3 id="_10-使用最频繁的列放到联合索引的左侧"><a href="#_10-使用最频繁的列放到联合索引的左侧" class="header-anchor">#</a> 10.使用最频繁的列放到联合索引的左侧</h3> <p>这样也可以较少的建立一些索引。同时，由于&quot;最左前缀原则&quot;，可以增加联合索引的使用率。</p> <h3 id="_11-在多个字段都要创建索引的情况下-联合索引优于单值索引"><a href="#_11-在多个字段都要创建索引的情况下-联合索引优于单值索引" class="header-anchor">#</a> 11.在多个字段都要创建索引的情况下，联合索引优于单值索引</h3> <h2 id="哪些情况不适合创建索引"><a href="#哪些情况不适合创建索引" class="header-anchor">#</a> 哪些情况不适合创建索引</h2> <h3 id="_1-where中使用不到的字段-不要设置索引"><a href="#_1-where中使用不到的字段-不要设置索引" class="header-anchor">#</a> 1.WHERE中使用不到的字段，不要设置索引</h3> <h3 id="_2-数据量小的表最好不要使用索引"><a href="#_2-数据量小的表最好不要使用索引" class="header-anchor">#</a> 2.数据量小的表最好不要使用索引</h3> <h3 id="_3-有大量重复数据的列上不要建立索引"><a href="#_3-有大量重复数据的列上不要建立索引" class="header-anchor">#</a> 3.有大量重复数据的列上不要建立索引</h3> <h3 id="_4-避免对经常更新的表创建过多的索引"><a href="#_4-避免对经常更新的表创建过多的索引" class="header-anchor">#</a> 4.避免对经常更新的表创建过多的索引</h3> <h3 id="_5-不建议用无序的值作为索引"><a href="#_5-不建议用无序的值作为索引" class="header-anchor">#</a> 5.不建议用无序的值作为索引</h3> <p>例如身份证、UUID(在索引比较时需要转为ASCII，并且插入时可能造成页分裂)、MD5、HASH、无序长字
符串等。</p> <h3 id="_6-删除不再使用或者很少使用的索引"><a href="#_6-删除不再使用或者很少使用的索引" class="header-anchor">#</a> 6.删除不再使用或者很少使用的索引</h3> <h3 id="_7-不要定义冗余或重复的索引"><a href="#_7-不要定义冗余或重复的索引" class="header-anchor">#</a> 7.不要定义冗余或重复的索引</h3></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/10/24, 03:39:33</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/java-notes/pages/198df0/" class="prev">MySQL体系结构</a></span> <span class="next"><a href="/java-notes/pages/ec5067/">MySQL调优</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2023
    <span>xiong201 | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/java-notes/assets/js/app.d397b22c.js" defer></script><script src="/java-notes/assets/js/2.f70b3895.js" defer></script><script src="/java-notes/assets/js/15.7637f176.js" defer></script>
  </body>
</html>
