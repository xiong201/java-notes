# 并发编程的三个重要特性

- **原子性** : 一个的操作或者多次操作，要么所有的操作全部都得到执行并且不会收到任何因素的干扰而中断，要么所有的操作都执行，要么都不执行。synchronized 可以保证代码片段的原子性。
- **可见性** ：当一个线程对共享变量进行了修改，那么另外的线程都是立即可以看到修改后的最新值。volatile 关键字可以保证共享变量的可见性。
- **有序性** ：代码在执行的过程中的先后顺序，Java 在编译器以及运行期间的优化，代码的执行顺序未必就是编写代码时候的顺序。volatile 关键字可以禁止指令进行重排序优化。

# JUC 概述

## JUC 简介

JUC 就是` java.util .concurrent` 工具包的简称。这是一个处理线程的工具包，JDK 1.5 开始出现的。  



## 进程与线程

**进程是程序的一次执行过程，是系统运行程序的基本单位**，因此进程是动态的。系统运行一个程序即是一个进程从创建，运行到消亡的过程。在 Java 中，当我们启动 main 函数时其实就是启动了⼀个 JVM 的进程，而 main 函数所在的线程就 是这个进程中的⼀个线程，也称主线程  。



**线程是⼀个比进程更小的执行单位。⼀个进程在其执行的过程中可以产生多个线 程**。与进程不同的是同类的多个线程共享进程的堆和方法区资源，但每个线程有自己的程序计数器、 虚拟机栈和本地方法栈，所以系统在产生⼀个线程，或是在各个线程之间作切换工作时，负担要比进程小得多，也正因为如此，线程也被称为轻量级进程 。



## 线程的状态

### 线程状态枚举类

`Thread.State `保存了所有线程状态。

- **NEW**：尚未启动的线程处于此状态。
- **RUNNABLE**：在 Java 虚拟机中执行的线程处于此状态。
- **BLOCKED**：被阻止等待监视器锁定的线程处于此状态。
- **WAITING** ：无限期等待另一个线程执行特定操作的线程处于此状态。
- **TIMED_WAITING**：等待另一个线程执行操作最多达到指定等待时间的线程处于此状态。
- **TERMINATED**：已退出的线程处于此状态。



### wait 和 sleep 

- sleep 是 Thread 的静态方法，wait 是 Object 的方法，任何对象实例都能调用。 
- sleep 不会释放锁，它也不需要占用锁。wait 会释放锁，但调用它的前提 是当前线程占有锁(即代码要在 synchronized 中)。 
- 它们都可以被 interrupted 方法中断。  



## 并发与并行

- **并发**：同一时刻多个线程在访问同一个资源，多个线程对一个点。例子：春运抢票 电商秒杀...
- **并行**：多项工作一起执行，之后再汇总。例子：泡方便面，电水壶烧水，一边撕调料倒入桶中  



## 管程

管程(monitor)是**保证了同一时刻只有一个进程在管程内活动**,即管程内定义的操作在同一时刻只被一个进程调用(由编译器实现) 。

执行线程首先要持有管程对象，然后才能执行方法，当方法完成之后会释放管程，方 法在执行时候会持有管程，其他线程无法再获取同一个管程 。



## 用户线程和守护线程

- **用户线程**：平时用到的普通线程，自定义线程 
- **守护线程**：运行在后台，是一种特殊的线程，比如垃圾回收 



**当主线程结束后，用户线程还在运行，JVM 存活，如果没有用户线程，都是守护线程，JVM 结束** 。







 